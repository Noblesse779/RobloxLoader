-- GUI à¸«à¸¥à¸±à¸
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "LockTargetGUI"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

-- à¸à¸£à¸­à¸š GUI (à¸¥à¸²à¸à¹„à¸”à¹‰)
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 220, 0, 150)
frame.Position = UDim2.new(0, 100, 0, 100)
frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

-- à¸›à¸¸à¹ˆà¸¡à¸¥à¹‡à¸­à¸à¹€à¸›à¹‰à¸²
local lockButton = Instance.new("TextButton")
lockButton.Size = UDim2.new(0, 200, 0, 40)
lockButton.Position = UDim2.new(0, 10, 0, 20)
lockButton.Text = "ðŸŽ¯ Lock Nearest Enemy OFF"
lockButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
lockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
lockButton.TextScaled = true
lockButton.Parent = frame

-- à¸›à¸¸à¹ˆà¸¡à¹€à¸›à¸´à¸”/à¸›à¸´à¸”à¹€à¸”à¸´à¸™à¸­à¸´à¸ªà¸£à¸°
local walkButton = Instance.new("TextButton")
walkButton.Size = UDim2.new(0, 200, 0, 40)
walkButton.Position = UDim2.new(0, 10, 0, 75)
walkButton.Text = "ðŸš¶ Walk Control OFF"
walkButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
walkButton.TextColor3 = Color3.fromRGB(255, 255, 255)
walkButton.TextScaled = true
walkButton.Parent = frame

-- à¸•à¸±à¸§à¹à¸›à¸£à¸«à¸¥à¸±à¸
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local localPlayer = Players.LocalPlayer
local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")
local camera = workspace.CurrentCamera

local aiming = false
local walkEnabled = false

-- à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸²à¹€à¸›à¹‰à¸²à¹ƒà¸à¸¥à¹‰à¸ªà¸¸à¸”
local function getClosestEnemy()
	local players = Players:GetPlayers()
	local closest = nil
	local shortestDist = math.huge

	for _, player in pairs(players) do
		if player ~= localPlayer and player.Team ~= localPlayer.Team then
			local char = player.Character
			if char and char:FindFirstChild("HumanoidRootPart") and char:FindFirstChild("Humanoid") and char.Humanoid.Health > 0 then
				local dist = (char.HumanoidRootPart.Position - hrp.Position).Magnitude
				if dist < shortestDist then
					shortestDist = dist
					closest = player
				end
			end
		end
	end

	return closest
end

-- à¸ªà¸¥à¸±à¸šà¸ªà¸–à¸²à¸™à¸°à¸¥à¹‡à¸­à¸à¹€à¸›à¹‰à¸²
lockButton.MouseButton1Click:Connect(function()
	aiming = not aiming
	if aiming then
		lockButton.Text = "ðŸŽ¯ Lock Nearest Enemy ON"
	else
		lockButton.Text = "ðŸŽ¯ Lock Nearest Enemy OFF"
	end
end)

-- à¸ªà¸¥à¸±à¸šà¸ªà¸–à¸²à¸™à¸°à¹€à¸”à¸´à¸™à¸­à¸´à¸ªà¸£à¸°
walkButton.MouseButton1Click:Connect(function()
	walkEnabled = not walkEnabled
	if walkEnabled then
		walkButton.Text = "ðŸš¶ Walk Control ON"
	else
		walkButton.Text = "ðŸš¶ Walk Control OFF"
	end
end)

-- à¸•à¸±à¸§à¹à¸›à¸£à¹€à¸à¹‡à¸šà¸—à¸´à¸¨à¸—à¸²à¸‡à¹€à¸”à¸´à¸™
local moveDirection = Vector3.new(0,0,0)

-- à¸­à¸±à¸›à¹€à¸”à¸•à¸—à¸´à¸¨à¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸•à¸²à¸¡à¸›à¸¸à¹ˆà¸¡à¸à¸” (à¸–à¹‰à¸²à¹€à¸›à¸´à¸”à¹€à¸”à¸´à¸™)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if not walkEnabled then return end

	if input.UserInputType == Enum.UserInputType.Keyboard then
		if input.KeyCode == Enum.KeyCode.W then
			moveDirection = moveDirection + Vector3.new(0,0,-1)
		elseif input.KeyCode == Enum.KeyCode.S then
			moveDirection = moveDirection + Vector3.new(0,0,1)
		elseif input.KeyCode == Enum.KeyCode.A then
			moveDirection = moveDirection + Vector3.new(-1,0,0)
		elseif input.KeyCode == Enum.KeyCode.D then
			moveDirection = moveDirection + Vector3.new(1,0,0)
		end
	end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if not walkEnabled then return end

	if input.UserInputType == Enum.UserInputType.Keyboard then
		if input.KeyCode == Enum.KeyCode.W then
			moveDirection = moveDirection - Vector3.new(0,0,-1)
		elseif input.KeyCode == Enum.KeyCode.S then
			moveDirection = moveDirection - Vector3.new(0,0,1)
		elseif input.KeyCode == Enum.KeyCode.A then
			moveDirection = moveDirection - Vector3.new(-1,0,0)
		elseif input.KeyCode == Enum.KeyCode.D then
			moveDirection = moveDirection - Vector3.new(1,0,0)
		end
	end
end)

-- à¸­à¸±à¸›à¹€à¸”à¸•à¸à¸¥à¹‰à¸­à¸‡à¹à¸¥à¸°à¹€à¸”à¸´à¸™à¸—à¸¸à¸à¹€à¸Ÿà¸£à¸¡
RunService.RenderStepped:Connect(function()
	-- à¸£à¸°à¸šà¸šà¸¥à¹‡à¸­à¸à¹€à¸›à¹‰à¸²
	if aiming then
		local target = getClosestEnemy()
		if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
			camera.CFrame = CFrame.new(camera.CFrame.Position, target.Character.HumanoidRootPart.Position)
		end
	end

	-- à¸£à¸°à¸šà¸šà¹€à¸”à¸´à¸™ (à¸–à¹‰à¸²à¹€à¸›à¸´à¸”)
	if walkEnabled then
		if moveDirection.Magnitude > 0 then
			local camCFrame = camera.CFrame
			local moveVec = (camCFrame.RightVector * moveDirection.X) + (camCFrame.LookVector * moveDirection.Z)
			moveVec = Vector3.new(moveVec.X, 0, moveVec.Z).Unit
			humanoid:Move(moveVec, false)
		else
			humanoid:Move(Vector3.new(0,0,0), false)
		end
	else
		humanoid:Move(Vector3.new(0,0,0), false)
	end
end)
